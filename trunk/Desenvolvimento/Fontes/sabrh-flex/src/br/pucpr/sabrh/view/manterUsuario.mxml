<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow width="900" creationComplete="init(event)" xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx" title="..:: Manutenção de Usuários ::.." close="fechar(event)" xmlns:controls="com.flexpernambuco.controls.*" xmlns:validator="br.pucpr.sabrh.components.validator.*" xmlns:formatter="br.pucpr.sabrh.components.formatter.*" xmlns:components="br.pucpr.sabrh.components.*">

	<fx:Script source="../controller/manterUsuario.as"/>

	<fx:Declarations>
		<s:RemoteObject id="usuarioService" fault="onFault(event)" destination="UsuarioService" showBusyCursor="true">
			<s:method name="listarUsuarios" result="{listarUsuariosResult(event)}"/>
			<s:method name="inserirUsuario" result="{inserirUsuarioResult(event)}"/>
		</s:RemoteObject>
		<s:RemoteObject id="municipioService" fault="onFault(event)" destination="MunicipioService" showBusyCursor="true">
			<s:method name="listarMunicipios" result="{listarMunicipiosResult(event)}"/>
		</s:RemoteObject>
		<s:RemoteObject id="estadoService" fault="onFault(event)" destination="EstadoService" showBusyCursor="true">
			<s:method name="listarEstados" result="{listarEstadosResult(event)}"/>
		</s:RemoteObject>
		<s:RemoteObject id="statusService" fault="onFault(event)" destination="StatusService" showBusyCursor="true">
			<s:method name="listarStatus" result="{listarStatusResult(event)}"/>
		</s:RemoteObject>
		<s:RemoteObject id="perfilService" fault="onFault(event)" destination="PerfilService" showBusyCursor="true">
			<s:method name="listarPerfil" result="{listarPerfilResult(event)}"/>
		</s:RemoteObject>

		<fx:Array id="val">
			<validator:CpfValidator source="{txtNovoCPF}" property="text" required="true"/>
		</fx:Array>

	</fx:Declarations>
	<s:states>
		<s:State name="statePesquisa"/>
		<s:State name="stateNovo"/>
		<s:State name="stateResultado"/>
	</s:states>

	<s:VGroup id="groupPesquisa" left="5" right="5" top="5" bottom="5" includeIn="statePesquisa,stateResultado">
		<s:Panel id="panelPesquisa" width="100%" height="100%" title="Pesquisa">
			<mx:Canvas left="5" right="5" top="5" bottom="5">
				<s:Label id="lblPesquisaNome" x="10" y="15" text="Nome"/>
				<s:Label id="lblPesquisaMunicipio" x="245" y="45" text="Municipio"/>
				<s:Label id="lblPesquisaStatus" x="245" y="75" text="Status"/>
				<s:Label id="lblPesquisaPerfil" x="10" y="75" text="Perfil"/>
				<s:TextInput id="txtPesquisaNome" x="60" y="10" width="514" tabIndex.statePesquisa="1"/>
				<s:ComboBox id="cmbPesquisaMunicipio" x="310" y="40" width="264" enabled="false" labelField="descricao" tabIndex.statePesquisa="3"/>
				<s:ComboBox id="cmbPesquisaStatus" x="310" y="70" width="264" tabIndex.statePesquisa="5"/>
				<s:ComboBox id="cmbPesquisaPerfil" x="60" y="70" width="171" tabIndex.statePesquisa="4"/>
				<s:Label id="lblPesquisaEstado" x="10" y="45" text="Estado"/>
				<s:ComboBox id="cmbPesquisaEstado" x="60" y="40" width="171" labelField="descricao" change="selecionaEstado(event)" tabIndex.statePesquisa="2"/>
			</mx:Canvas>
			<s:controlBarContent>
				<s:Button label="Pesquisar" click="{pesquisar()}" tabIndex.statePesquisa="6"/>
				<s:Button label="Novo" click="actionNovoUsuario(event)" tabIndex.statePesquisa="7"/>
			</s:controlBarContent>
		</s:Panel>
		<s:Panel id="panelResultado" width="100%" height="100%" title="Resultado" includeIn="stateResultado">
			<mx:AdvancedDataGrid id="gridUsuario" left="5" right="5" top="5" bottom="5" designViewDataType="flat">
				<mx:columns>
					<mx:AdvancedDataGridColumn textAlign="left" headerText="Nome" dataField="nome"/>
					<mx:AdvancedDataGridColumn textAlign="center" headerText="CPF" dataField="cpf"/>
					<mx:AdvancedDataGridColumn textAlign="center" headerText="Perfil" dataField="perfil"/>
					<mx:AdvancedDataGridColumn textAlign="center" headerText="Status" dataField="status"/>
				</mx:columns>
			</mx:AdvancedDataGrid>

		</s:Panel>
	</s:VGroup>
	<s:VGroup id="groupNovo" left="5" right="5" top="5" bottom="5" includeIn="stateNovo">
		<s:Panel id="panelNovo" width="100%" height="100%" title="Novo">
			<mx:Canvas left="5" right="5" top="5" bottom="5">
				<s:Label id="lblNovoNome" x="10" y="15" text="Nome"/>
				<s:Label id="lblNovoMunicipio" x="245" y="45" text="Municipio"/>
				<s:Label id="lblNovoStatus" x="245" y="75" text="Status"/>
				<s:Label id="lblNovoPerfil" x="10" y="75" text="Perfil"/>
				<s:Label id="lblNovoEstado" x="10" y="45" text="Estado"/>
				<s:Label id="lblNovoCPF" x="10" y="105" text="CPF"/>
				<s:Label id="lblNovoLogin" x="10" y="135" text="Login"/>
				<s:Label id="lblNovoSenha" x="10" y="165" text="Senha"/>
				<s:Label id="lblNovoConfirmacaoSenha" x="245" y="165" text="Confirmar Senha"/>
				<s:TextInput id="txtNovoNome" x="60" y="10" width="514" maxChars="255" tabIndex="1"/>
				<!--<s:TextInput id="txtNovoCPF" x="60" y="100" width="171" tabIndex="6" focusOut="{txtNovoCPF.text = formaterCpfCnpj.format(txtNovoCPF.text)}" focusIn="{txtNovoCPF.text = formaterCpfCnpj.format(txtNovoCPF.text)}"/>-->
				<components:TextInputCPF id="txtNovoCPF" x="60" y="100" width="171" tabIndex="6"/>
				<s:TextInput id="txtNovoLogin" x="60" y="130" width="171" tabIndex="7"/>
				<s:TextInput id="txtNovoConfirmarSenha" x="343" y="160" width="231" displayAsPassword="true" tabIndex="9"/>
				<s:TextInput id="txtNovoSenha" x="59" y="160" width="171" displayAsPassword="true" tabIndex="8"/>
				<s:ComboBox id="cmbNovoMunicipio" x="310" y="40" width="264" enabled="false" labelField="descricao" tabIndex="3"/>
				<s:ComboBox id="cmbNovoStatus" x="310" y="70" width="264" tabIndex="5"/>
				<s:ComboBox id="cmbNovoPerfil" x="60" y="70" width="171" tabIndex="4"/>
				<s:ComboBox id="cmbNovoEstado" x="60" y="40" width="171" labelField="descricao" change="selecionaEstado(event)" tabIndex="2"/>
			</mx:Canvas>

			<s:controlBarContent>
				<s:Button label="Salvar" click="{salvarUsuario()}"/>
				<s:Button label="Limpar" click="actionNovoUsuario(event)"/>
				<s:Button label="Voltar" click="voltarPesquisa(event)"/>
			</s:controlBarContent>
		</s:Panel>
	</s:VGroup>
</s:TitleWindow>
